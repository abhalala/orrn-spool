<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" id="printer-modal">
  <div class="bg-white rounded-lg shadow-xl w-full max-w-md mx-4">
    <div class="p-4 border-b flex justify-between items-center">
      <h3 class="text-lg font-semibold text-gray-900">{{ if .Printer.ID }}Edit Printer{{ else }}Add Printer{{ end }}</h3>
      <button onclick="document.getElementById('printer-modal').remove()" class="text-gray-400 hover:text-gray-600 text-2xl leading-none">&times;</button>
    </div>
    
    <form hx-post="/api/printers{{ if .Printer.ID }}/{{ .Printer.ID }}{{ end }}" 
          hx-target="#printer-grid"
          hx-swap="innerHTML"
          hx-on::after-request="if(event.detail.successful) document.getElementById('printer-modal').remove()">
      {{ if .Printer.ID }}
      <input type="hidden" name="id" value="{{ .Printer.ID }}">
      {{ end }}
      
      <div class="p-4 space-y-4">
        <div>
          <label for="name" class="block text-sm font-medium text-gray-700 mb-1">Name <span class="text-red-500">*</span></label>
          <input type="text" 
                 id="name" 
                 name="name" 
                 value="{{ .Printer.Name }}"
                 required
                 class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
                 placeholder="e.g., Warehouse Printer 1">
        </div>
        
        <div class="grid grid-cols-3 gap-4">
          <div class="col-span-2">
            <label for="ip_address" class="block text-sm font-medium text-gray-700 mb-1">IP Address <span class="text-red-500">*</span></label>
            <input type="text" 
                   id="ip_address" 
                   name="ip_address" 
                   value="{{ .Printer.IPAddress }}"
                   required
                   pattern="^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$"
                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
                   placeholder="192.168.1.100">
          </div>
          <div>
            <label for="port" class="block text-sm font-medium text-gray-700 mb-1">Port</label>
            <input type="number" 
                   id="port" 
                   name="port" 
                   value="{{ if .Printer.Port }}{{ .Printer.Port }}{{ else }}9100{{ end }}"
                   min="1"
                   max="65535"
                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
                   placeholder="9100">
          </div>
        </div>
        
        <div>
          <label for="dpi" class="block text-sm font-medium text-gray-700 mb-1">DPI</label>
          <select id="dpi" 
                  name="dpi" 
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500">
            <option value="203" {{ if eq .Printer.DPI 203 }}selected{{ end }}>203 DPI</option>
            <option value="300" {{ if eq .Printer.DPI 300 }}selected{{ end }}>300 DPI</option>
            <option value="600" {{ if eq .Printer.DPI 600 }}selected{{ end }}>600 DPI</option>
          </select>
        </div>
        
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label for="label_width" class="block text-sm font-medium text-gray-700 mb-1">Label Width (mm)</label>
            <input type="number" 
                   id="label_width" 
                   name="label_width" 
                   value="{{ .Printer.LabelWidth }}"
                   min="1"
                   step="0.5"
                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
                   placeholder="50">
          </div>
          <div>
            <label for="label_height" class="block text-sm font-medium text-gray-700 mb-1">Label Height (mm)</label>
            <input type="number" 
                   id="label_height" 
                   name="label_height" 
                   value="{{ .Printer.LabelHeight }}"
                   min="1"
                   step="0.5"
                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
                   placeholder="25">
          </div>
        </div>
        
        <div>
          <label for="gap" class="block text-sm font-medium text-gray-700 mb-1">Gap (mm)</label>
          <input type="number" 
                 id="gap" 
                 name="gap" 
                 value="{{ if .Printer.Gap }}{{ .Printer.Gap }}{{ else }}2{{ end }}"
                 min="0"
                 step="0.5"
                 class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
                 placeholder="2">
        </div>

        {{ if .Error }}
        <div class="p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700">
          {{ .Error }}
        </div>
        {{ end }}
      </div>
      
      <div class="p-4 border-t bg-gray-50 rounded-b-lg flex justify-end space-x-3">
        <button type="button" 
                onclick="document.getElementById('printer-modal').remove()" 
                class="px-4 py-2 text-gray-700 hover:text-gray-900 font-medium transition-colors">
          Cancel
        </button>
        <button type="submit" 
                class="bg-primary-600 hover:bg-primary-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
          Save Printer
        </button>
      </div>
    </form>
  </div>
</div>
